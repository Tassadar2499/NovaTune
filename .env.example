# =============================================================================
# NovaTune Environment Configuration
# =============================================================================
# Copy this file to .env and update values for your environment:
#   cp .env.example .env
#
# IMPORTANT: Never commit .env to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# RavenDB Configuration
# -----------------------------------------------------------------------------
# RavenDB document database connection settings.
# Studio UI available at: http://localhost:8080

RAVENDB_URL=http://localhost:8080
RAVENDB_DATABASE=NovaTune

# Optional: For cluster deployments, comma-separated URLs
# RAVENDB_URLS=http://node1:8080,http://node2:8080,http://node3:8080

# Optional: Certificate path for secure connections
# RAVENDB_CERT_PATH=./certs/ravendb.pfx
# RAVENDB_CERT_PASSWORD=

# -----------------------------------------------------------------------------
# MinIO (S3-Compatible Storage)
# -----------------------------------------------------------------------------
# Object storage for audio files. S3-compatible API.
# Console UI available at: http://localhost:9001

MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_USE_SSL=false

# Bucket configuration
MINIO_BUCKET_AUDIO=novatune-audio
MINIO_BUCKET_COVERS=novatune-covers
MINIO_BUCKET_TEMP=novatune-temp

# Presigned URL expiration (in seconds)
MINIO_PRESIGNED_EXPIRY=3600

# -----------------------------------------------------------------------------
# Messaging (Redpanda)
# -----------------------------------------------------------------------------
# Redpanda provides Kafka-compatible messaging.
# Admin API available at: http://localhost:9644
# Console UI available at: http://localhost:8181 (with debug profile)

REDPANDA_BROKERS=localhost:19092
REDPANDA_SASL_ENABLED=false
REDPANDA_SASL_USERNAME=
REDPANDA_SASL_PASSWORD=
TOPIC_PREFIX=dev

# Topic names (auto-created via init-topics.sh)
# ${TOPIC_PREFIX}-audio-events - 3 partitions, 7d retention
# ${TOPIC_PREFIX}-track-deletions - 3 partitions, compaction, 30d retention

# Consumer settings
REDPANDA_GROUP_ID=novatune-api
REDPANDA_CLIENT_ID=novatune-producer
REDPANDA_AUTO_OFFSET_RESET=earliest

# -----------------------------------------------------------------------------
# Cache (Garnet)
# -----------------------------------------------------------------------------
# Garnet is a Redis-compatible cache with AOF persistence.
# Uses StackExchange.Redis client.

GARNET_CONNECTION=localhost:6379
GARNET_PASSWORD=
GARNET_SSL_ENABLED=false

# Cache expiration defaults (in seconds)
GARNET_SESSION_EXPIRY=1800
GARNET_URL_CACHE_EXPIRY=3600
GARNET_METADATA_CACHE_EXPIRY=300

# -----------------------------------------------------------------------------
# JWT Configuration
# -----------------------------------------------------------------------------
# Authentication token settings.
# IMPORTANT: Generate strong keys for production!

JWT_ISSUER=https://novatune.local
JWT_AUDIENCE=novatune-api

# Signing key configuration
# Option 1: Path to PEM key file
JWT_SIGNING_KEY_PATH=./keys/signing.pem
# Option 2: Base64-encoded key (for containerized deployments)
# JWT_SIGNING_KEY_BASE64=

# Token expiration
JWT_ACCESS_TOKEN_EXPIRY_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRY_DAYS=7

# Optional: RSA key pair for asymmetric signing
# JWT_PUBLIC_KEY_PATH=./keys/public.pem
# JWT_PRIVATE_KEY_PATH=./keys/private.pem

# -----------------------------------------------------------------------------
# Password Hashing (Argon2)
# -----------------------------------------------------------------------------
# Password hashing parameters. Adjust based on server capabilities.
# Higher values = more secure but slower.

ARGON2_MEMORY_SIZE=65536
ARGON2_ITERATIONS=4
ARGON2_PARALLELISM=4

# -----------------------------------------------------------------------------
# Audio Processing
# -----------------------------------------------------------------------------
# FFmpeg/FFprobe configuration for audio transcoding.

FFMPEG_PATH=/usr/bin/ffmpeg
FFPROBE_PATH=/usr/bin/ffprobe

# Transcoding settings
AUDIO_MAX_UPLOAD_SIZE_MB=500
AUDIO_ALLOWED_FORMATS=mp3,flac,wav,aac,ogg,m4a
AUDIO_DEFAULT_BITRATE=320k
AUDIO_THUMBNAIL_SIZE=300

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# ASP.NET Core configuration.

ASPNETCORE_ENVIRONMENT=Development
ASPNETCORE_URLS=https://localhost:5001;http://localhost:5000

# Logging
LOG_LEVEL=Information
LOG_FORMAT=json

# CORS (comma-separated origins)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# Rate limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=20

# -----------------------------------------------------------------------------
# Observability
# -----------------------------------------------------------------------------
# OpenTelemetry and monitoring configuration.

OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=novatune-api
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1

# Aspire Dashboard (when running with Aspire)
ASPIRE_DASHBOARD_URL=http://localhost:18888

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
# Toggle features on/off for development/testing.

FEATURE_ANALYTICS_ENABLED=true
FEATURE_TRANSCODING_ENABLED=true
FEATURE_EMAIL_VERIFICATION_REQUIRED=false
